/* =========================================================
   Fonts
   ========================================================= */
@font-face {
  font-family: 'Atkinson Hyperlegible';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(../fonts/AtkinsonHyperlegible/AtkinsonHyperlegible-Regular.woff2)
    format('woff2');
}
@font-face {
  font-family: 'Atkinson Hyperlegible';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: url(../fonts/AtkinsonHyperlegible/AtkinsonHyperlegible-Italic.woff2)
    format('woff2');
}
@font-face {
  font-family: 'Atkinson Hyperlegible';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: url(../fonts/AtkinsonHyperlegible/AtkinsonHyperlegible-Bold.woff2)
    format('woff2');
}
@font-face {
  font-family: 'Atkinson Hyperlegible';
  font-style: italic;
  font-weight: 700;
  font-display: swap;
  src: url(../fonts/AtkinsonHyperlegible/AtkinsonHyperlegible-BoldItalic.woff2)
    format('woff2');
}

/* =========================================================
   Design tokens
   ========================================================= */
:root {
  --radius-xsmall: 2px;
  --radius-medium: 0.5rem;
  --radius-large: 1rem;

  --space-xsmall: 0.25rem;
  --space-small: 0.5rem;
  --space-medium: 0.75rem;
  --space-large: 1rem;
  --space-xlarge: 1.5rem;

  --font-sans:
    'Atkinson Hyperlegible', system-ui, -apple-system, Segoe UI, Roboto, Ubuntu,
    Cantarell, Noto Sans, Arial, sans-serif;
  --font-mono:
    ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono',
    monospace;
  --text-small: 0.9rem;
  --text-medium: 1rem;
  --text-large: 1.25rem;
  --text-xlarge: 1.75rem;

  --default-background: #0e1120;
  --accent-light: #e9eef7;
  --accent-primary: #d3ccff;
  --accent-secondary: #9a7dff;

  --card-background: #eee;
  --border-strong: 4px solid #ddd;
  --border-subtle: 1px solid
    color-mix(in oklab, var(--accent-light) 15%, transparent);

  --shadow-1: 0 2px 8px rgba(0, 0, 0, 0.25);

  --code-font-size: 0.9rem;
  --line-number-w: 2em;
  --line-highlight-background: rgba(255, 255, 0, 0.2);

  --status-good-background: rgba(0, 200, 0, 0.2);
  --status-good-border: 3px solid green;
  --status-warn-background: rgba(255, 200, 0, 0.25);
  --status-warn-border: 3px solid orange;
  --status-bad-background: rgba(255, 0, 0, 0.15);
  --status-bad-border: 3px solid red;

  --risk-low-background: rgba(255, 0, 0, 0.3);
  --risk-med-background: rgba(255, 165, 0, 0.3);
  --risk-high-background: rgba(60, 179, 113, 0.3);

  --label-pad: 0 0.25em;
}

/* =========================================================
   Base layout and typography
   ========================================================= */
body {
  margin: 0;
  padding: 0 var(--space-large);
  height: 100vh;
  display: flex;
  flex-direction: column;
  color: #333;
  font: 400 var(--text-medium) / 1.5 var(--font-sans);
}

h1,
h2 {
  a {
    color: inherit;
  }
}

.content {
  flex: 1 0 auto;
}

.footer {
  flex-shrink: 0;
}

.acorn {
  position: relative;
  top: 0.12rem;
}

.credits {
  text-align: end;
  padding: var(--space-large) 0;
}

.chart-container {
  position: relative;
  max-height: 60vh;
}

code {
  font-size: 1.1em;
}

/* =========================================================
   Line highlighting and code blocks
   ========================================================= */
.line {
  display: inline-block;
  width: 100%;
  box-sizing: border-box;

  .line-number-trigger {
    display: inline-block;
    width: var(--line-number-w);
    margin-inline-end: 0.5em;
    color: #888;
    font-size: 0.75em;
    text-align: end;
    user-select: none;
    cursor: pointer;

    &:hover {
      color: #007aff;
      text-decoration: underline;
    }
  }

  &.highlighted-line {
    user-select: none;
    background: var(--line-highlight-background);
  }
}

.high,
.medium,
.low,
.ignored {
  padding: var(--label-pad);
  border-radius: var(--radius-xsmall);
}

.high {
  background: var(--risk-high-background);
}

.medium {
  background: var(--risk-med-background);
}

.low {
  background: var(--risk-low-background);
}

.ignored {
  background: rgba(0, 0, 0, 0.05);
  cursor: help;
}

.awdty__line {
  position: relative;
}

.shiki {
  white-space: pre;
  overflow-x: auto;
  padding: var(--space-large);
  border-radius: var(--radius-medium);
  font-family: var(--font-mono);
  font-size: var(--code-font-size);
}

/* =========================================================
   Status banners (data-status)
   ========================================================= */
[data-status='good'] {
  background-color: var(--status-good-background);
  border-left: var(--status-good-border);

  :last-of-type::after {
    content: ' ✅';
    font-size: 0.9em;
    margin-inline-start: 0.2em;
  }
}

[data-status='warn'] {
  background-color: var(--status-warn-background);
  border-left: var(--status-warn-border);

  :last-of-type::after {
    content: ' ☑️';
    font-size: 0.9em;
    margin-inline-start: 0.2em;
  }
}

[data-status='bad'] {
  background-color: var(--status-bad-background);
  border-left: var(--status-bad-border);

  :last-of-type::after {
    content: ' ❌';
    font-size: 0.9em;
    margin-inline-start: 0.2em;
  }
}

/* =========================================================
   Stats grid, controls, lists
   ========================================================= */
.stats-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 1.25rem;
  margin-block: 0;
  padding: 0;

  @media (min-width: 900px) {
    grid-template-columns: 1fr 1fr;
  }
}

.controls {
  background: var(--card-background);
  padding: var(--space-small) var(--space-large);
  border-radius: var(--radius-large);
  border: var(--border-strong);
}

.control {
  margin: var(--space-large) 0;
}

.button {
  border-radius: 0.375rem;
  border: 1px solid transparent;
  cursor: pointer;
}

.tokens,
.properties,
.descriptors {
  background: var(--card-background);
  padding: 0 var(--space-xlarge) var(--space-large);
  border-radius: var(--radius-large);
  margin-top: var(--space-xlarge);

  h3 {
    display: inline-block;
  }

  code {
    color: green;
  }
}

.token-list,
.non-token-list {
  margin: 0;
  padding: 0 var(--space-large) var(--space-large);

  padding-inline-start: 1.5ch; /* room for 1–9 plus dot/space */

  /* 10–99: add one more digit of room */
  @supports selector(ol:has(li)) {
    &:has(li:nth-child(n + 10)) {
      padding-inline-start: 2.5ch;
    }
    /* 100–999 */
    &:has(li:nth-child(n + 100)) {
      padding-inline-start: 3.5ch;
    }
    /* 1000+ */
    &:has(li:nth-child(n + 1000)) {
      padding-inline-start: 4.5ch;
    }
  }
}

.non-token-item,
.token-item {
  margin-block: 0.5rem 0.75rem;

  summary {
    cursor: pointer;
  }

  details {
    margin-top: 0.25rem;
  }
}

.paths {
  margin: 0.35rem 0 0.25rem 0;
  padding-inline-start: 1.25rem;
}

.form-help {
  font-size: 0.9rem;
  opacity: 0.8;
  margin-top: 0.25rem;
}

.notice {
  padding: 0.5rem 0.75rem;
  border-radius: 0.375rem;
  margin-top: 0.5rem;

  &.error {
    background: rgba(220, 53, 69, 0.08);
    border: 1px solid rgba(220, 53, 69, 0.35);
    color: #5a1a1f;
  }
}

.controls {
  background: var(--card-background);
  padding: var(--space-small) var(--space-large);
  border-radius: var(--radius-large);
  border: var(--border-strong);
}

.control {
  margin: var(--space-large) 0;
}

/* =========================================================
   Toolbar header (mobile first)
   ========================================================= */
header {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  justify-content: space-between;
  margin: 0 calc(var(--space-large) * -1);
  gap: var(--space-small);
  padding: 0.6rem 0.9rem;
  color: var(--accent-light);
  background: linear-gradient(
    90deg,
    color-mix(in oklab, var(--default-background) 88%, black 12%),
    color-mix(
        in oklab,
        var(--accent-secondary) 22%,
        var(--default-background) 78%
      )
      45%
  );
  border-bottom: var(--border-subtle);
  box-shadow: var(--shadow-1);
  position: relative;
  z-index: 100;

  h1 {
    margin: 0.5rem 0;
    font-size: var(--text-xlarge);
    font-weight: 500;
    white-space: nowrap;
    flex: 1 0 100%;

    ::before {
      content: '';
      display: inline-block;
      width: 2.3rem;
      height: 1.8rem;
      background-image: url('../img/token.svg');
      background-size: cover;
      top: 0.3rem;
      position: relative;
      margin-inline-end: 0.5rem;
    }

    a:link {
      text-decoration: none;
    }

    a:hover,
    a:active {
      text-decoration: underline;
    }
  }

  .menu {
    width: 100%;

    ul {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin: 0;
      padding: 0;
      list-style: none;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
      padding-bottom: 0.25rem;

      &::-webkit-scrollbar {
        display: none;
      }
    }

    li {
      overflow: hidden;
      border-radius: 0.5rem;
      padding: 0;
      position: relative;
      font-size: 0.95rem;
      font-weight: 500;
      white-space: nowrap;
      background: color-mix(in oklab, var(--accent-light) 8%, transparent);
      transition:
        background-color 0.2s ease,
        color 0.2s ease,
        transform 0.06s ease;

      a {
        color: inherit;
        text-decoration: none;
        display: block;
      }

      a,
      &.active {
        padding: 0.55rem 0.8rem;
      }

      a:hover {
        background: color-mix(in oklab, var(--accent-light) 12%, transparent);
      }

      :is(a, button):focus-visible,
      &:focus-visible {
        outline: none;
        box-shadow: 0 0 0 2px
          color-mix(in oklab, var(--accent-light) 65%, white 35%);
        border-radius: 0.6rem;
      }

      &.active,
      &[aria-current='page'] {
        background: linear-gradient(
          90deg,
          var(--accent-primary),
          color-mix(in oklab, var(--accent-primary) 75%, white 25%)
        );
        color: #0b0f1a;
        box-shadow: 0 1px 4px rgba(0, 0, 0, 0.25);
      }

      &:active {
        transform: translateY(1px);
      }

      &:not(.active):not([aria-current='page'])::after {
        display: none;
        content: '';
      }
    }
  }

  @media (min-width: 641px) {
    gap: var(--space-large);
    padding: 0.75rem 1.5rem;

    h1 {
      flex: initial;
    }

    .menu {
      width: auto;

      ul {
        gap: 1.1rem;
        padding-bottom: 0;
      }

      li {
        &:not(.active):not([aria-current='page'])::after {
          content: '';
          position: absolute;
          left: 0.85rem;
          right: 0.85rem;
          bottom: 0.25rem;
          height: 2px;
          background: linear-gradient(90deg, var(--accent-secondary));
          opacity: 0;
          transition: opacity 0.2s ease;
        }

        &:hover::after {
          opacity: 0.7;
        }
      }
    }
  }
}

/* =========================================================
   Motion
   ========================================================= */
@media (prefers-reduced-motion: reduce) {
  .menu li,
  .menu li::after {
    transition: none;
  }
}
